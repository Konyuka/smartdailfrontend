{"remainingRequest":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\user\\Desktop\\TAILTASK\\user\\src\\components\\modals\\CampaignModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\src\\components\\modals\\CampaignModal.vue","mtime":1610537500957},{"path":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\TAILTASK\\user\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTd2FsIGZyb20gJ3N3ZWV0YWxlcnQyJzsKd2luZG93LlN3YWwgPSBTd2FsOwpjb25zdCBUb2FzdCA9IFN3YWwubWl4aW4oewogIHRvYXN0OiB0cnVlLAogIHBvc2l0aW9uOiAndG9wLWVuZCcsCiAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogIHRpbWVyOiA1MDAwLAogIHRpbWVyUHJvZ3Jlc3NCYXI6IGZhbHNlLAogIGRpZE9wZW46ICh0b2FzdCkgPT4gewogICAgdG9hc3QuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VlbnRlciIsIFN3YWwuc3RvcFRpbWVyKTsKICAgIHRvYXN0LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbGVhdmUiLCBTd2FsLnJlc3VtZVRpbWVyKTsKICB9LAp9KTsKd2luZG93LlRvYXN0ID0gVG9hc3Q7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NhbXBhaWduTW9kYWwnLAogIGRhdGEoKXsKICAgIHJldHVybnsKICAgICAgbW9kYWw6IHRydWUsCiAgICAgIG9wdGlvbnM6IFtdLAogICAgICBzZWxlY3RlZENhbXBhaWduOiBudWxsLAogICAgICBzZWVuOiBmYWxzZSwKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICAgdGhpcy5vcHRpb25zID0gdGhpcy4kc3RvcmUuc3RhdGUuY2FtcGFpZ25zCiAgfSwKICBjb21wdXRlZDogewogICAgaXNEaXNhYmxlKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZENhbXBhaWduID09IG51bGw7CiAgICB9LAogICAgc2VsZWN0KCl7CiAgICAgIHJldHVybiB0aGlzLiRwYXJlbnQuc2VsZWN0CiAgICB9LAogICAgY2FtcGFpZ25zKCl7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5jYW1wYWlnbnM7CiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIGFzeW5jIHN1Ym1pdENhbXBhaWduKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdGVkQ2FtcGFpZ24pCiAgICAgIHRyeSB7CiAgICAgICAgbGV0IHBheWxvYWQgPSB7IHVzZXJuYW1lOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpLCBjYW1wYWlnbjogdGhpcy5zZWxlY3RlZENhbXBhaWduIH0KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FtcGFpZ25UZW1wJywgdGhpcy5zZWxlY3RlZENhbXBhaWduKQogICAgICAgIHRoaXMuJHBhcmVudC5zZWxlY3QgPSBmYWxzZTsKICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QoIi9hcGkvdjEvY2FtcGFpZ24vbG9naW4gIiwgcGF5bG9hZCwgeyBoZWFkZXJzOiB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwgIkF1dGhvcml6YXRpb24iOiBgQmVhcmVyICR7bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyl9YCB9IH0pOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgIHRoaXMuYWZ0ZXJMb2dpbigpCiAgICAgICAgcmVzcG9uc2UuZGF0YS5jYW1wYWlnbiA9IHRoaXMuc2VsZWN0ZWRDYW1wYWlnbgogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpCiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldFBob25lQ2FtcHMiLCByZXNwb25zZS5kYXRhKTsgCiAgICAgICAgaWYoIHRoaXMuJHN0b3JlLnN0YXRlLmRpYWxfbWV0aG9kID09ICdSQVRJTycpewogICAgICAgICAgdGhpcy4kcGFyZW50LmJsZW5kTW9kYWwgPSB0cnVlCiAgICAgICAgfQogICAgICB9IAogICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICBpZihlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yID09ICdsb2dpbiB0aW1lb3V0Jyl7CiAgICAgICAgICBsZXQgcGF5bG9hZCA9IHsgdGl0bGU6ICdDYWxsIEFnZW50IEFnYWluJywgdGV4dDogJ0tpbmRseSBwaWNrIHRoZSBjYWxsIHRvIHN0YXJ0IGEgY29uZmVyZW5jZS5Zb3UgbXVzdCBzZWxlY3QgYSBjYW1wYWlnbiB0byBzdWNjZXNzZnVsbHkgbG9naW4gdG8gdGhlIHN5c3RlbSBhbmQgcmVjaWV2ZSB0aGUgY2FsbCcsfQogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInJlc2V0RXJyb3IiLHBheWxvYWQpOwogICAgICAgIH1lbHNlewogICAgICAgICAgbGV0IHBheWxvYWQgPSB7IHRpdGxlOiAnTG9naW4gRmFpbGVkICcsIHRleHQ6IGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3IgfQogICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInJlc2V0RXJyb3IiLHBheWxvYWQpOwogICAgICAgIH0KCgogICAgICAgIHRoaXMuJHBhcmVudC5jYW1wYWlnbk1vZGFsID0gdHJ1ZQogICAgICAgIHRoaXMuJHBhcmVudC50cnlBZ2FpbiA9IHRydWUKICAgICAgICB0aGlzLiRwYXJlbnQuZXJyb3JNb2RhbCA9IHRydWUKICAgICAgICAvL2NvbnNvbGUubG9nKGVycm9yKQogICAgICB9CiAgICB9LAogICAgYWZ0ZXJMb2dpbigpewogICAgICB0aGlzLiRwYXJlbnQuc2VsZWN0ID0gZmFsc2UKICAgICAgdGhpcy53ZWJTb2NrZXQoKQogICAgICAKICAgIH0sCiAgICB3ZWJTb2NrZXQoKXsKICAgICAgbGV0IGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KCJ3czovLyIgKyB0aGlzLiRzb2NrZXQgKyIvYXBpL3YxL3dzIikKICAgICAgY29ubmVjdGlvbi5vbm9wZW4gPSAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coIlN1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gdGhlICB3ZWJzb2NrZXQgc2VydmVyIikKICAgICAgICBsZXQgcGF5bG9hZCA9IHsidXNlcm5hbWUiOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpLCJwaG9uZSI6bG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Bob25lJyksICJjYW1wYWlnbiI6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYW1wYWlnbicpfQogICAgICAgIGNvbm5lY3Rpb24uc2VuZChKU09OLnN0cmluZ2lmeShwYXlsb2FkKSkKICAgICAgICBUb2FzdC5maXJlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICB0aXRsZTogJ1N1Y2Nlc3NmdWwgTG9naW4nLAogICAgICAgICAgICBpY29uOiAnc3VjY2VzcycsCiAgICAgICAgICB9KTsKICAgICAgfTsKICAgICAgY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSAobWVzc2FnZSkgPT4gewogICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShtZXNzYWdlLmRhdGEpOwogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJmcm9tV2Vic29ja2V0IiwgZGF0YSk7CiAgICAgIH07CiAgICAgIGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICBjb25zb2xlLmxvZygnU29ja2V0IGlzIGNsb3NlZC4gUmVjb25uZWN0IHdpbGwgYmUgYXR0ZW1wdGVkIGluIDEgc2Vjb25kLicsIGUucmVhc29uKTsKICAgICAgICB0aGlzLiRwYXJlbnQuc2hvd2NhbXBhaWduTW9kYWwgPSB0cnVlCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgIHRoaXMud2ViU29ja2V0KCk7CiAgICAgICAgfSwgMjAwMCk7CiAgICAgIH07CiAgICAgIGNvbm5lY3Rpb24ub25lcnJvciA9IChldnQpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygiU29ja2V0IGNsb3NlZDogIiwgZXZ0KTsKICAgICAgfTsKICAgIH0sCiAgICBsb2dvdXQoKSB7CiAgICAgIGxldCBwYXlsb2FkID0geyAidXNlcm5hbWUiOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpLCB9CiAgICAgIGxldCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpCiAgICAgIHJldHVybiB0aGlzLiRodHRwCiAgICAgICAgLnBvc3QoIi9hcGkvdjEvbG9nb3V0IiwgcGF5bG9hZCwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGBCZWFyZXIgJHt0b2tlbn1gCiAgICAgICAgICB9LAogICAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGlmKHJlc3BvbnNlKXsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJsb2dvdXQiKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvIik7CgogICAgICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UpOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5zdGF0dXMpOwogICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlLmRhdGEuc3RhdHVzID09ICJVbmF1dGhvcml6ZWQiKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJsb2dvdXQiKTsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIiIpOwogICAgICAgICAgfQogICAgICAgICAgfSkKICAgIH0sCiAgfQp9Cg=="},{"version":3,"sources":["CampaignModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CampaignModal.vue","sourceRoot":"src/components/modals","sourcesContent":["<template>\n  <div>\n    <!-- Campaign Modal -->\n    <div v-if=\"modal\" class=\"fixed z-10 inset-0 overflow-y-auto\">\n      <div class=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n        \n        <div class=\"fixed inset-0 transition-opacity\" aria-hidden=\"true\">\n          <div class=\"absolute inset-0 bg-gray-500 opacity-75\"></div>\n        </div>\n\n        <!-- This element is to trick the browser into centering the modal contents. -->\n        <span class=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">&#8203;</span>\n      \n        <div class=\"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-headline\">\n          \n          <div v-if=\"select\">\n          <div>\n            <label id=\"listbox-label\" class=\"text-center block text-md font-medium text-black\">\n              Select User Campaign\n            </label>\n            <div class=\"mt-4 px-20\">\n            <select v-model=\"selectedCampaign\"  class=\"w-full border bg-white rounded px-3 py-2 outline-none\">\n              <option v-for=\"option in options\" :key=\"option\" >{{ option }}</option>\n            </select>\n            </div>\n          </div>\n\n          <div class=\"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense\">\n            <button @click=\"submitCampaign\" type=\"button\" class=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-900 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:col-start-2 sm:text-sm\">\n              Submit\n            </button>\n            <button  @click.prevent=\"logout\" type=\"button\" class=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:col-start-1 sm:text-sm\">\n              Logout\n            </button>\n          </div>\n          </div>\n\n        <div v-else class=\"m-auto w-1/2\">\n          <div >\n          <h3 class=\"text-lg font-bold text-gray-700\">\n            Answer Phone Conference\n          </h3>    \n          <svg class=\"h-28 w-28 ml-14 pt-5 transition duration-500 ease-in-out text-indigo-400 hover:text-indigo-900 transform hover:-translate-y-1 hover:scale-110\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n          </svg>\n          </div>\n        </div>\n\n        </div>\n\n\n\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Swal from 'sweetalert2';\nwindow.Swal = Swal;\nconst Toast = Swal.mixin({\n  toast: true,\n  position: 'top-end',\n  showConfirmButton: false,\n  timer: 5000,\n  timerProgressBar: false,\n  didOpen: (toast) => {\n    toast.addEventListener(\"mouseenter\", Swal.stopTimer);\n    toast.addEventListener(\"mouseleave\", Swal.resumeTimer);\n  },\n});\nwindow.Toast = Toast;\n\nexport default {\n  name: 'CampaignModal',\n  data(){\n    return{\n      modal: true,\n      options: [],\n      selectedCampaign: null,\n      seen: false,\n    }\n  },\n  mounted() {\n     this.options = this.$store.state.campaigns\n  },\n  computed: {\n    isDisable() {\n      return this.selectedCampaign == null;\n    },\n    select(){\n      return this.$parent.select\n    },\n    campaigns(){\n      return this.$store.state.campaigns;\n    }\n  },\n  methods:{\n    async submitCampaign() {\n      console.log(this.selectedCampaign)\n      try {\n        let payload = { username: localStorage.getItem('user'), campaign: this.selectedCampaign }\n        localStorage.setItem('campaignTemp', this.selectedCampaign)\n        this.$parent.select = false;\n        let response = await this.$http.post(\"/api/v1/campaign/login \", payload, { headers: { \"Content-Type\": \"application/json\",\"Accept\": \"application/json\", \"Authorization\": `Bearer ${localStorage.getItem('token')}` } });\n        console.log(response)\n        this.afterLogin()\n        response.data.campaign = this.selectedCampaign\n        console.log(response.data)\n        this.$store.dispatch(\"setPhoneCamps\", response.data); \n        if( this.$store.state.dial_method == 'RATIO'){\n          this.$parent.blendModal = true\n        }\n      } \n      catch (error) {\n        console.log(error)\n        if(error.response.data.error == 'login timeout'){\n          let payload = { title: 'Call Agent Again', text: 'Kindly pick the call to start a conference.You must select a campaign to successfully login to the system and recieve the call',}\n          this.$store.dispatch(\"resetError\",payload);\n        }else{\n          let payload = { title: 'Login Failed ', text: error.response.data.error }\n          this.$store.dispatch(\"resetError\",payload);\n        }\n\n\n        this.$parent.campaignModal = true\n        this.$parent.tryAgain = true\n        this.$parent.errorModal = true\n        //console.log(error)\n      }\n    },\n    afterLogin(){\n      this.$parent.select = false\n      this.webSocket()\n      \n    },\n    webSocket(){\n      let connection = new WebSocket(\"ws://\" + this.$socket +\"/api/v1/ws\")\n      connection.onopen = () => {\n        console.log(\"Successfully connected to the  websocket server\")\n        let payload = {\"username\": localStorage.getItem('user'),\"phone\":localStorage.getItem('phone'), \"campaign\": localStorage.getItem('campaign')}\n        connection.send(JSON.stringify(payload))\n        Toast.fire({\n            type: 'success',\n            title: 'Successful Login',\n            icon: 'success',\n          });\n      };\n      connection.onmessage = (message) => {\n        let data = JSON.parse(message.data);\n        this.$store.dispatch(\"fromWebsocket\", data);\n      };\n      connection.onclose = function(e) {\n        console.log('Socket is closed. Reconnect will be attempted in 1 second.', e.reason);\n        this.$parent.showcampaignModal = true\n        setTimeout(function() {\n          this.webSocket();\n        }, 2000);\n      };\n      connection.onerror = (evt) => {\n        console.log(\"Socket closed: \", evt);\n      };\n    },\n    logout() {\n      let payload = { \"username\": localStorage.getItem('user'), }\n      let token = localStorage.getItem('token')\n      return this.$http\n        .post(\"/api/v1/logout\", payload, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"Accept\": \"application/json\",\n            \"Authorization\": `Bearer ${token}`\n          },\n          })\n        .then((response) => {\n          if(response){\n            console.log(response.data)\n          }\n          this.$store.dispatch(\"logout\");\n          this.$router.push(\"/\");\n\n           })\n        .catch((error) => {\n          console.log(error.response);\n          console.log(error.response.data.status);\n          if (error.response.data.status == \"Unauthorized\") {\n            this.$store.dispatch(\"logout\");\n            this.$router.push(\"\");\n          }\n          })\n    },\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n\n</style>\n"]}]}